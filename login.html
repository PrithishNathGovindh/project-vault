<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Project Showcase</title>

<script src="https://unpkg.com/lucide@latest"></script>

<style>
  * {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(to bottom right, #eff6ff, #e0e7ff);
}

.container {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.card {
  background: white;
  width: 100%;
  max-width: 420px;
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}

.logo {
  text-align: center;
  margin-bottom: 20px;
}

.logo-box {
  background: #4f46e5;
  padding: 15px;
  border-radius: 15px;
  display: inline-block;
}

h1 {
  margin: 10px 0 5px;
}

.subtitle {
  color: gray;
  margin-bottom: 20px;
}

input {
  width: 100%;
  padding: 10px;
  padding-right: 40px;
  border-radius: 8px;
  border: 1px solid #ccc;
  height: 40px;
}

label {
  display: block;
  margin-bottom: 5px;
}

.input-group {
  margin-bottom: 18px;
}

.password-wrapper {
  position: relative;
}

.password-wrapper button {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  border: none;
  background: none;
  cursor: pointer;
}

button.submit-btn {
  width: 100%;
  height: 45px;
  background: #4f46e5;
  border: none;
  color: white;
  border-radius: 8px;
  cursor: pointer;
}

button.submit-btn:hover {
  background: #4338ca;
}

.toggle-link {
  text-align: center;
  margin-top: 20px;
  font-size: 14px;
}

.toggle-link button {
  background: none;
  border: none;
  color: #4f46e5;
  cursor: pointer;
  font-weight: bold;
}

.error {
  color: red;
  font-size: 14px;
  margin-bottom: 15px;
}

.hidden {
  display: none;
}
small {
  font-size: 12px;
}
</style>
</head>

<body>

<div class="container">
<div class="card">

  <div class="logo">
    <div class="logo-box">
      <i data-lucide="graduation-cap" style="color:white;"></i>
    </div>
    <h1>Project Showcase</h1>
    <p class="subtitle">Academic Innovation Platform</p>
  </div>

  <h2 id="formTitle">Welcome Back</h2>

  <div id="error" class="error"></div>

  <form id="authForm">

    <!-- Full Name -->
    <div class="input-group hidden" id="nameGroup">
      <label>Full Name</label>
      <input type="text" id="name">
    </div>

    <!-- Email -->
    <div class="input-group">
      <label>College Email ID</label>
      <input type="email" id="email" required placeholder="your.name@college.edu">
      <small id="emailWarning" style="color:orange;"></small>
    </div>

    <!-- College -->
    <div class="input-group hidden" id="collegeGroup">
      <label>College/University Name (Optional)</label>
      <input type="text" id="college">
      <small id="autoCollege" style="color:gray;"></small>
    </div>

    <!-- Department -->
    <div class="input-group hidden" id="departmentGroup">
      <label>Department/Branch</label>
      <input type="text" id="department">
    </div>

    <!-- Password -->
    <div class="input-group">
      <label>Password</label>
      <div class="password-wrapper">
        <input type="password" id="password" required>
        <button type="button" id="togglePassword">
          <i data-lucide="eye"></i>
        </button>
      </div>
    </div>

    <!-- Confirm Password -->
    <div class="input-group hidden" id="confirmGroup">
      <label>Confirm Password</label>
      <div class="password-wrapper">
        <input type="password" id="confirmPassword">
        <button type="button" id="toggleConfirmPassword">
          <i data-lucide="eye"></i>
        </button>
      </div>
    </div>
    <!-- CAPTCHA (Only for Login) -->
<div class="input-group" id="captchaGroup">
  <label>Solve CAPTCHA</label>
  <div style="display:flex; gap:10px; align-items:center;">
    <span id="captchaQuestion" style="font-weight:bold;"></span>
    <button type="button" onclick="generateCaptcha()" style="padding:5px;">â†»</button>
  </div>
  <input type="text" id="captchaInput" placeholder="Enter answer">
</div>


    <button type="submit" class="submit-btn" id="submitBtn">Sign In</button>
  </form>

  <div class="toggle-link">
    <span id="toggleText">Don't have an account?</span>
    <button onclick="toggleMode()" id="toggleBtn">Register with College Email</button>
  </div>

</div>
</div>

<script>
lucide.createIcons();
let captchaAnswer = 0;

function generateCaptcha() {
  const num1 = Math.floor(Math.random() * 10) + 1;
  const num2 = Math.floor(Math.random() * 10) + 1;

  captchaAnswer = num1 + num2;

  document.getElementById("captchaQuestion").textContent =
    num1 + " + " + num2 + " = ?";
}

generateCaptcha();

let isRegister = false;

// Elements
const nameGroup = document.getElementById("nameGroup");
const collegeGroup = document.getElementById("collegeGroup");
const departmentGroup = document.getElementById("departmentGroup");
const confirmGroup = document.getElementById("confirmGroup");
const formTitle = document.getElementById("formTitle");
const submitBtn = document.getElementById("submitBtn");
const toggleText = document.getElementById("toggleText");
const toggleBtn = document.getElementById("toggleBtn");
const errorDiv = document.getElementById("error");

function resetForm() {
  document.getElementById("authForm").reset();
  errorDiv.textContent = "";
}

function toggleMode() {
  isRegister = !isRegister;

  nameGroup.classList.toggle("hidden");
  collegeGroup.classList.toggle("hidden");
  departmentGroup.classList.toggle("hidden");
  confirmGroup.classList.toggle("hidden");

  formTitle.textContent = isRegister ? "Create Account" : "Welcome Back";
  submitBtn.textContent = isRegister ? "Create Account" : "Sign In";
  toggleText.textContent = isRegister ? "Already have an account?" : "Don't have an account?";
  toggleBtn.textContent = isRegister ? "Sign In" : "Register with College Email";
  //captchaGroup.style.display = isRegister ? "none" : "block";
  //generateCaptcha()
  resetForm();
}

// Email validation
function isValidCollegeEmail(email) {
  const patterns = [
    /\.edu$/i,
    /\.ac\.\w+$/i,
    /\.edu\.\w+$/i
  ];
  return patterns.some(pattern => pattern.test(email));
}

// Extract college
function extractCollege(email) {
  const domain = email.split('@')[1]?.split('.')[0];
  if (!domain) return '';
  return domain
    .split(/[-_]/)
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(' ');
}

// Toggle password visibility
function togglePassword(inputId, btnId) {
  const input = document.getElementById(inputId);
  const btn = document.getElementById(btnId);

  const type = input.type === "password" ? "text" : "password";
  input.type = type;

  btn.innerHTML = type === "password"
    ? '<i data-lucide="eye"></i>'
    : '<i data-lucide="eye-off"></i>';

  lucide.createIcons();
}

document.getElementById("togglePassword")
  .addEventListener("click", () => togglePassword("password", "togglePassword"));

document.getElementById("toggleConfirmPassword")
  .addEventListener("click", () => togglePassword("confirmPassword", "toggleConfirmPassword"));

// Live email feedback
document.getElementById("email").addEventListener("input", function () {
  const email = this.value;
  const warning = document.getElementById("emailWarning");
  const autoCollege = document.getElementById("autoCollege");

  if (isRegister && email && !isValidCollegeEmail(email)) {
    warning.textContent = "Please use a valid college email (.edu, .ac.in, etc.)";
  } else {
    warning.textContent = "";
  }

  if (isRegister && email) {
    autoCollege.textContent = "Will auto-fill as: " + extractCollege(email);
  } else {
    autoCollege.textContent = "";
  }
});

// Form submit
document.getElementById("authForm").addEventListener("submit", function (e) {
  e.preventDefault();
  errorDiv.textContent = "";

  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value;
  const confirmPassword = document.getElementById("confirmPassword").value;
  const name = document.getElementById("name").value.trim();
  const college = document.getElementById("college").value.trim();
  const department = document.getElementById("department").value.trim();

  if (isRegister) {

    if (!isValidCollegeEmail(email)) {
      errorDiv.textContent = "Please use a valid college email address.";
      return;
    }

    if (password.length < 6) {
      errorDiv.textContent = "Password must be at least 6 characters long.";
      return;
    }

    if (password !== confirmPassword) {
      errorDiv.textContent = "Passwords do not match.";
      return;
    }

    if (!name) {
      errorDiv.textContent = "Please enter your full name.";
      return;
    }

    if (!department) {
      errorDiv.textContent = "Please enter your department.";
      return;
    }

    const finalCollege = college || extractCollege(email);

    console.log({
      name,
      email: email.toLowerCase(),
      college: finalCollege,
      department
    });

    alert("Registration Successful!");
  } else {

    if (!email || !password) {
      errorDiv.textContent = "Please enter both email and password.";
      return;
    }

    console.log({
      name: "Demo User",
      email: email.toLowerCase(),
      college: extractCollege(email) || "Demo College",
      department: "Computer Science"
    });
     const captchaInput = document.getElementById("captchaInput").value;

      if (parseInt(captchaInput) !== captchaAnswer) {
        errorDiv.textContent = "Incorrect CAPTCHA. Please try again.";
        generateCaptcha();
        return;
      }

    alert("Login Successful!");
  }
});
</script>

</body>
</html>
